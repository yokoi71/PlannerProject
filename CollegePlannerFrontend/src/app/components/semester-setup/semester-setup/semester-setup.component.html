<app-header></app-header>

<!-- Toast Notifications Container -->
<div class="fixed top-4 right-4 z-50 space-y-3">
  <div
    *ngFor="let toast of toastMessages"
    class="min-w-96 max-w-lg w-full bg-white shadow-xl rounded-xl pointer-events-auto ring-1 ring-black ring-opacity-5 overflow-hidden transform transition-all duration-300 ease-in-out"
    [ngClass]="{
      'border-l-6 border-red-500': toast.type === 'error',
      'border-l-6 border-green-500': toast.type === 'success',
      'border-l-6 border-yellow-500': toast.type === 'warning',
      'border-l-6 border-blue-500': toast.type === 'info'
    }"
  >
    <div class="p-6">
      <div class="flex items-start">
        <div class="flex-shrink-0">
          <i
            class="fa text-2xl"
            [ngClass]="{
              'fa-exclamation-circle text-red-500': toast.type === 'error',
              'fa-check-circle text-green-500': toast.type === 'success',
              'fa-exclamation-triangle text-yellow-500':
                toast.type === 'warning',
              'fa-info-circle text-blue-500': toast.type === 'info'
            }"
          ></i>
        </div>
        <div class="ml-4 w-0 flex-1">
          <p class="text-base font-semibold text-gray-900 leading-relaxed">
            {{ toast.message }}
          </p>
        </div>
        <div class="ml-4 flex-shrink-0 flex">
          <button
            (click)="removeToast(toast.id)"
            class="bg-white rounded-lg inline-flex text-gray-400 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 p-1"
          >
            <span class="sr-only">Close</span>
            <i class="fa fa-times text-lg"></i>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="flex flex-col gap-8 p-6 sm:p-8 md:p-10">
  <!-- Header Section -->
  <section
    class="bg-blue-900 bg-opacity-90 rounded-xl shadow-lg p-2 sm:p-3 md:p-4 text-white"
  >
    <h1
      class="text-xl font-bold text-white !text-white"
      style="color: white !important"
    >
      Semester Settings
    </h1>
  </section>

  <!-- Semester Settings Section -->
  <section
    class="bg-blue-200 bg-opacity-80 rounded-xl shadow-lg p-8 sm:p-10 md:p-12 text-blue-900"
  >
    <h2 class="text-lg font-semibold mb-6">Semester Settings</h2>
    <div class="flex items-center gap-4 mb-6">
      <label class="text-base font-medium pt-2" for="semesterSelect"
        >Semester</label
      >
      <select
        id="semesterSelect"
        [(ngModel)]="selectedSemester"
        class="px-4 py-3 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 bg-white text-blue-900 font-medium"
      >
        <ng-container *ngFor="let year of [currentYear, nextYear]">
          <option [ngValue]="null" disabled>-- {{ year }} --</option>
          <option *ngFor="let sem of semesters" [ngValue]="year + '-' + sem">
            {{ year }} {{ sem | titlecase }}
          </option>
        </ng-container>
      </select>
    </div>
    <div
      *ngIf="selectedSemester"
      class="bg-white bg-opacity-90 rounded-lg p-6 shadow-sm"
    >
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <label
            class="block text-sm font-semibold text-blue-800 mb-2 relative group"
          >
            Start Date
            <span
              class="absolute left-1/2 -translate-x-1/2 -top-8 z-10 hidden group-hover:block bg-gray-800 text-white text-xs rounded px-2 py-1 whitespace-nowrap"
              >Start Date</span
            >
          </label>
          <input
            type="date"
            [(ngModel)]="semesterSettings.startDate"
            class="w-full px-4 py-3 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
          />
        </div>
        <div>
          <label
            class="block text-sm font-semibold text-blue-800 mb-2 relative group"
          >
            End Date
            <span
              class="absolute left-1/2 -translate-x-1/2 -top-8 z-10 hidden group-hover:block bg-gray-800 text-white text-xs rounded px-2 py-1 whitespace-nowrap"
              >End Date</span
            >
          </label>
          <input
            type="date"
            [(ngModel)]="semesterSettings.endDate"
            class="w-full px-4 py-3 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
          />
        </div>
      </div>
      <div class="flex justify-end mt-6">
        <button
          (click)="saveSemesterSettings()"
          class="px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 focus:ring-4 focus:ring-blue-300 transition-colors duration-200 transform hover:scale-105"
        >
          Save Settings
        </button>
      </div>
    </div>
  </section>

  <!-- Holiday Settings Section -->
  <section
    class="bg-blue-200 bg-opacity-80 rounded-xl shadow-lg p-8 sm:p-10 md:p-12 text-blue-900"
  >
    <h2 class="text-lg font-semibold mb-6">Holiday Settings</h2>
    <div class="bg-white bg-opacity-90 rounded-lg p-6 shadow-sm mb-6">
      <div class="flex flex-col gap-4">
        <div
          class="flex items-center gap-4 font-semibold text-blue-800 mb-2"
          *ngIf="allHolidays.length > 0"
        >
          <div class="w-1/4 relative group">
            Name
            <span
              class="absolute left-1/2 -translate-x-1/2 -top-8 z-10 hidden group-hover:block bg-gray-800 text-white text-xs rounded px-2 py-1 whitespace-nowrap"
              >Name</span
            >
          </div>
          <div class="w-1/4 relative group">
            Start Date
            <span
              class="absolute left-1/2 -translate-x-1/2 -top-8 z-10 hidden group-hover:block bg-gray-800 text-white text-xs rounded px-2 py-1 whitespace-nowrap"
              >Start Date</span
            >
          </div>
          <div class="w-1/4 relative group">
            End Date
            <span
              class="absolute left-1/2 -translate-x-1/2 -top-8 z-10 hidden group-hover:block bg-gray-800 text-white text-xs rounded px-2 py-1 whitespace-nowrap"
              >End Date</span
            >
          </div>
          <div class="w-1/4"></div>
        </div>
        <!-- Debug: reminders count = {{allHolidays.length}} -->
        <div *ngIf="allHolidays.length === 0" class="text-gray-500 italic">
          No Holiday found. Click "Add Holiday" to create one.
        </div>
        <div
          *ngFor="let holiday of allHolidays; let i = index"
          class="flex items-center gap-4"
        >
          <input
            type="text"
            [(ngModel)]="holiday.name"
            placeholder="Holiday Name"
            class="w-1/4 px-4 py-3 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
            [ngClass]="{
              'text-gray-400': !holiday.name || holiday.name.trim() === '',
              'text-gray-900': holiday.name && holiday.name.trim() !== ''
            }"
          />
          <input
            type="date"
            [(ngModel)]="holiday.startDate"
            placeholder="Start Date"
            class="w-1/4 px-4 py-3 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
            [ngClass]="{
              'text-gray-400': !holiday.startDate,
              'text-gray-900': holiday.startDate
            }"
          />
          <input
            type="date"
            [(ngModel)]="holiday.endDate"
            placeholder="End Date"
            class="w-1/4 px-4 py-3 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
            [ngClass]="{
              'text-gray-400': !holiday.endDate,
              'text-gray-900': holiday.endDate
            }"
          />
          <button
            (click)="saveHoliday(i)"
            class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:ring-4 focus:ring-blue-300 transition-colors duration-200 mr-2"
          >
            <i class="fa fa-save"></i> Save
          </button>
          <button
            (click)="deleteHoliday(i)"
            class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 focus:ring-4 focus:ring-red-300 transition-colors duration-200"
          >
            <i class="fa fa-trash"></i> Delete
          </button>
        </div>
      </div>
      <div class="flex justify-end mt-6">
        <button
          (click)="addHoliday()"
          class="px-6 py-3 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 focus:ring-4 focus:ring-green-300 transition-colors duration-200 transform hover:scale-105"
        >
          <i class="fa fa-plus mr-2"></i>Add Holiday
        </button>
      </div>
    </div>
  </section>

  <!-- Event Settings Section -->
  <section
    class="bg-blue-200 bg-opacity-80 rounded-xl shadow-lg p-8 sm:p-10 md:p-12 text-blue-900"
  >
    <h2 class="text-lg font-semibold mb-6">Event Settings</h2>
    <div class="bg-white bg-opacity-90 rounded-lg p-6 shadow-sm mb-6">
      <div class="flex flex-col gap-4">
        <div
          class="flex flex-wrap items-center gap-4 font-semibold text-blue-800 mb-2"
          *ngIf="events.length > 0"
        >
          <div class="w-1/6 relative group">
            Name
            <span
              class="absolute left-1/2 -translate-x-1/2 -top-8 z-10 hidden group-hover:block bg-gray-800 text-white text-xs rounded px-2 py-1 whitespace-nowrap"
              >Name</span
            >
          </div>
          <div class="w-1/12 relative group">
            Start Date
            <span
              class="absolute left-1/2 -translate-x-1/2 -top-8 z-10 hidden group-hover:block bg-gray-800 text-white text-xs rounded px-2 py-1 whitespace-nowrap"
              >Start Date</span
            >
          </div>
          <div class="w-1/12 relative group">
            End Date
            <span
              class="absolute left-1/2 -translate-x-1/2 -top-8 z-10 hidden group-hover:block bg-gray-800 text-white text-xs rounded px-2 py-1 whitespace-nowrap"
              >End Date</span
            >
          </div>
          <div class="w-1/12 relative group">
            Start Time
            <span
              class="absolute left-1/2 -translate-x-1/2 -top-8 z-10 hidden group-hover:block bg-gray-800 text-white text-xs rounded px-2 py-1 whitespace-nowrap"
              >Start Time</span
            >
          </div>
          <div class="w-1/12 relative group">
            End Time
            <span
              class="absolute left-1/2 -translate-x-1/2 -top-8 z-10 hidden group-hover:block bg-gray-800 text-white text-xs rounded px-2 py-1 whitespace-nowrap"
              >End Time</span
            >
          </div>
          <div class="w-1/6 relative group">
            Location
            <span
              class="absolute left-1/2 -translate-x-1/2 -top-8 z-10 hidden group-hover:block bg-gray-800 text-white text-xs rounded px-2 py-1 whitespace-nowrap"
              >Location</span
            >
          </div>
          <div class="w-1/6 relative group">
            Notes
            <span
              class="absolute left-1/2 -translate-x-1/2 -top-8 z-10 hidden group-hover:block bg-gray-800 text-white text-xs rounded px-2 py-1 whitespace-nowrap"
              >Notes</span
            >
          </div>
          <div class="w-1/12 relative group">
            Reminder Days
            <span
              class="absolute left-1/2 -translate-x-1/2 -top-8 z-10 hidden group-hover:block bg-gray-800 text-white text-xs rounded px-2 py-1 whitespace-nowrap"
              >Reminder Days</span
            >
          </div>
          <div class="w-1/12"></div>
        </div>
        <!-- Debug: events count = {{events.length}} -->
        <div *ngIf="events.length === 0" class="text-gray-500 italic">
          No events found. Click "Add Event" to create one.
        </div>
        <div
          *ngFor="let event of events; let i = index"
          class="flex flex-wrap items-center gap-4"
        >
          <input
            type="text"
            [(ngModel)]="event.name"
            placeholder="Event Name"
            class="w-1/6 px-4 py-3 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
            [ngClass]="{
              'text-gray-400': !event.name || event.name.trim() === '',
              'text-gray-900': event.name && event.name.trim() !== ''
            }"
          />
          <input
            type="date"
            [(ngModel)]="event.startDate"
            placeholder="Start Date"
            class="w-1/12 px-4 py-3 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
            [ngClass]="{
              'text-gray-400': !event.startDate,
              'text-gray-900': event.startDate
            }"
          />
          <input
            type="date"
            [(ngModel)]="event.endDate"
            placeholder="End Date"
            class="w-1/12 px-4 py-3 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
            [ngClass]="{
              'text-gray-400': !event.endDate,
              'text-gray-900': event.endDate
            }"
          />
          <input
            type="time"
            [(ngModel)]="event.startTime"
            placeholder="Start Time"
            class="w-1/12 px-4 py-3 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
            [ngClass]="{
              'text-gray-400': !event.startTime,
              'text-gray-900': event.startTime
            }"
          />
          <input
            type="time"
            [(ngModel)]="event.endTime"
            placeholder="End Time"
            class="w-1/12 px-4 py-3 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
            [ngClass]="{
              'text-gray-400': !event.endTime,
              'text-gray-900': event.endTime
            }"
          />
          <input
            type="text"
            [(ngModel)]="event.location"
            placeholder="Location"
            class="w-1/6 px-4 py-3 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
            [ngClass]="{
              'text-gray-400': !event.location || event.location.trim() === '',
              'text-gray-900': event.location && event.location.trim() !== ''
            }"
          />
          <input
            type="text"
            [(ngModel)]="event.notes"
            placeholder="Notes"
            class="w-1/6 px-4 py-3 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
            [ngClass]="{
              'text-gray-400': !event.notes || event.notes.trim() === '',
              'text-gray-900': event.notes && event.notes.trim() !== ''
            }"
          />
          <input
            type="number"
            min="0"
            [(ngModel)]="event.reminderDays"
            placeholder="Reminder Days"
            class="w-1/12 px-4 py-3 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
            [ngClass]="{
              'text-gray-400': !event.reminderDays && event.reminderDays !== 0,
              'text-gray-900': event.reminderDays || event.reminderDays === 0
            }"
          />
          <button
            (click)="saveEvent(i)"
            class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:ring-4 focus:ring-blue-300 transition-colors duration-200 mr-2"
          >
            <i class="fa fa-save"></i> Save
          </button>
          <button
            (click)="deleteEvent(i)"
            class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 focus:ring-4 focus:ring-red-300 transition-colors duration-200"
          >
            <i class="fa fa-trash"></i> Delete
          </button>
        </div>
      </div>
      <div class="flex justify-end mt-6">
        <button
          (click)="addEvent()"
          class="px-6 py-3 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 focus:ring-4 focus:ring-green-300 transition-colors duration-200 transform hover:scale-105"
        >
          <i class="fa fa-plus mr-2"></i>Add Event
        </button>
      </div>
    </div>
  </section>

  <!-- Reminder Settings Section -->
  <section
    class="bg-blue-200 bg-opacity-80 rounded-xl shadow-lg p-8 sm:p-10 md:p-12 text-blue-900"
  >
    <h2 class="text-lg font-semibold mb-6">Reminder Settings</h2>
    <div class="bg-white bg-opacity-90 rounded-lg p-6 shadow-sm mb-6">
      <div class="flex flex-col gap-4">
        <div
          class="flex flex-wrap items-center gap-4 font-semibold text-blue-800 mb-2"
          *ngIf="reminders.length > 0"
        >
          <div class="w-1/6 relative group">
            Title
            <span
              class="absolute left-1/2 -translate-x-1/2 -top-8 z-10 hidden group-hover:block bg-gray-800 text-white text-xs rounded px-2 py-1 whitespace-nowrap"
              >Title</span
            >
          </div>
          <div class="w-1/4 relative group">
            Description
            <span
              class="absolute left-1/2 -translate-x-1/2 -top-8 z-10 hidden group-hover:block bg-gray-800 text-white text-xs rounded px-2 py-1 whitespace-nowrap"
              >Description</span
            >
          </div>
          <div class="w-1/6 relative group">
            Reminder Date
            <span
              class="absolute left-1/2 -translate-x-1/2 -top-8 z-10 hidden group-hover:block bg-gray-800 text-white text-xs rounded px-2 py-1 whitespace-nowrap"
              >Reminder Date</span
            >
          </div>
          <div class="w-1/6 relative group">
            Reminder Time
            <span
              class="absolute left-1/2 -translate-x-1/2 -top-8 z-10 hidden group-hover:block bg-gray-800 text-white text-xs rounded px-2 py-1 whitespace-nowrap"
              >Reminder Time</span
            >
          </div>
          <div class="w-1/6 relative group">
            Recurring
            <span
              class="absolute left-1/2 -translate-x-1/2 -top-8 z-10 hidden group-hover:block bg-gray-800 text-white text-xs rounded px-2 py-1 whitespace-nowrap"
              >Recurring</span
            >
          </div>
          <div class="w-1/12"></div>
        </div>
        <!-- Debug: reminders count = {{reminders.length}} -->
        <div *ngIf="reminders.length === 0" class="text-gray-500 italic">
          No reminders found. Click "Add Reminder" to create one.
        </div>
        <div
          *ngFor="let reminder of reminders; let i = index"
          class="flex flex-wrap items-center gap-4"
        >
          <input
            type="text"
            [(ngModel)]="reminder.title"
            placeholder="Reminder Title"
            class="w-1/6 px-4 py-3 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
            [ngClass]="{
              'text-gray-400': !reminder.title || reminder.title.trim() === '',
              'text-gray-900': reminder.title && reminder.title.trim() !== ''
            }"
          />
          <input
            type="text"
            [(ngModel)]="reminder.description"
            placeholder="Description"
            class="w-1/4 px-4 py-3 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
            [ngClass]="{
              'text-gray-400':
                !reminder.description || reminder.description.trim() === '',
              'text-gray-900':
                reminder.description && reminder.description.trim() !== ''
            }"
          />
          <input
            type="date"
            [(ngModel)]="reminder.reminderDate"
            placeholder="Reminder Date"
            class="w-1/6 px-4 py-3 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
            [ngClass]="{
              'text-gray-400': !reminder.reminderDate,
              'text-gray-900': reminder.reminderDate
            }"
          />
          <input
            type="time"
            [(ngModel)]="reminder.reminderTime"
            placeholder="Reminder Time"
            class="w-1/6 px-4 py-3 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
            [ngClass]="{
              'text-gray-400': !reminder.reminderTime,
              'text-gray-900': reminder.reminderTime
            }"
          />
          <select
            [(ngModel)]="reminder.recurring"
            class="w-1/6 px-4 py-3 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
            [ngClass]="{
              'text-gray-400': !reminder.recurring,
              'text-gray-900': reminder.recurring
            }"
          >
            <option value="None">None</option>
            <option value="Daily">Daily</option>
            <option value="Weekly">Weekly</option>
          </select>
          <button
            (click)="saveReminder(i)"
            class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:ring-4 focus:ring-blue-300 transition-colors duration-200 mr-2"
          >
            <i class="fa fa-save"></i> Save
          </button>
          <button
            (click)="deleteReminder(i)"
            class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 focus:ring-4 focus:ring-red-300 transition-colors duration-200"
          >
            <i class="fa fa-trash"></i> Delete
          </button>
        </div>
      </div>
      <div class="flex justify-end mt-6">
        <button
          (click)="addReminder()"
          class="px-6 py-3 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 focus:ring-4 focus:ring-green-300 transition-colors duration-200 transform hover:scale-105"
        >
          <i class="fa fa-plus mr-2"></i>Add Reminder
        </button>
      </div>
    </div>
  </section>
</div>
